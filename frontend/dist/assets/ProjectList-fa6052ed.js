import{_ as R,W as A,y as x,C as N,z as J,c as p,b as c,d as e,w as a,a as W,i as G,B,E as F,r as i,o as n,e as u,g as v,F as U,A as E,t as r,x as w}from"./index-9a8ac2de.js";const H={name:"ProjectList",components:{Loading:A},setup(){W();const L=G(),l=x([]),D=x([]),o=x([]),P=N({myProjects:!1,joinedProjects:!1,allProjects:!1}),b=x("myProjects"),f=N({searchTerm:"",status:"",priority:""}),m=N({currentPage:1,total:0,perPage:10}),j=async()=>{P.myProjects=!0;try{const s=await B.get("/api/v1/projects/user");l.value=s.data.created}catch(s){console.error("加载我的项目失败:",s),F.error("加载我的项目失败，请稍后重试")}finally{P.myProjects=!1}},g=async()=>{P.joinedProjects=!0;try{const s=await B.get("/api/v1/projects/user");D.value=s.data.joined}catch(s){console.error("加载参与的项目失败:",s),F.error("加载参与的项目失败，请稍后重试")}finally{P.joinedProjects=!1}},_=async()=>{P.allProjects=!0;try{const s={page:m.currentPage,per_page:m.perPage,status:f.status,priority:f.priority};f.searchTerm&&(s.q=f.searchTerm);const d=await B.get("/api/v1/projects",{params:s});o.value=d.data.projects,m.total=d.data.total,m.currentPage=d.data.current_page}catch(s){console.error("加载项目列表失败:",s),F.error("加载项目列表失败，请稍后重试")}finally{P.allProjects=!1}},z=s=>{const d=s.props.name;d==="myProjects"&&l.value.length===0?j():d==="joinedProjects"&&D.value.length===0?g():d==="allProjects"&&o.value.length===0&&_()};let h=null;const k=()=>{h&&clearTimeout(h),h=setTimeout(()=>{m.currentPage=1,_()},500)},T=()=>{f.searchTerm="",f.status="",f.priority="",m.currentPage=1,b.value==="myProjects"?j():b.value==="joinedProjects"?g():_()},C=s=>{m.currentPage=s,_()},V=s=>{switch(s){case"进行中":return"success";case"已完成":return"primary";case"已取消":return"danger";default:return"info"}},y=s=>s?new Date(s).toLocaleDateString("zh-CN"):"未设置";return J(()=>{const s=L.query.tab;s&&["myProjects","joinedProjects","allProjects"].includes(s)&&(b.value=s),b.value==="myProjects"?j():b.value==="joinedProjects"?g():_()}),{myProjects:l,joinedProjects:D,allProjects:o,loading:P,activeTab:b,filters:f,pagination:m,loadProjects:_,loadMyProjects:j,loadJoinedProjects:g,handleTabClick:z,debounceSearch:k,resetFilters:T,goToPage:C,getStatusTagType:V,formatDate:y}}},K={class:"project-list"},O={class:"page-header"},Q={class:"filter-container"},X={key:0,class:"loading-container"},Y={class:"card-header"},Z={class:"project-title"},$={class:"project-desc"},ee={class:"card-tags"},te={class:"card-footer"},ae={key:0},oe={key:1},le={key:0,class:"loading-container"},se={class:"card-header"},ne={class:"project-title"},re={class:"project-desc"},ie={class:"card-tags"},de={class:"card-footer"},ce={key:0},_e={key:1},ue={key:0,class:"loading-container"},me={key:2},fe={key:0,class:"pagination-container"};function pe(L,l,D,o,P,b){const f=i("el-button"),m=i("router-link"),j=i("el-input"),g=i("el-col"),_=i("el-option"),z=i("el-select"),h=i("el-row"),k=i("el-card"),T=i("Loading"),C=i("el-icon"),V=i("el-empty"),y=i("el-tag"),s=i("el-tab-pane"),d=i("el-table-column"),I=i("el-table"),M=i("el-pagination"),q=i("el-tabs");return n(),p("div",K,[c("div",O,[l[7]||(l[7]=c("h2",{class:"page-title"},"项目管理",-1)),e(m,{to:{name:"ProjectCreate"}},{default:a(()=>[e(f,{type:"primary"},{default:a(()=>l[6]||(l[6]=[u("创建新项目")])),_:1})]),_:1})]),e(k,{class:"mb-4"},{default:a(()=>[c("div",Q,[e(h,{gutter:20},{default:a(()=>[e(g,{span:8},{default:a(()=>[e(j,{modelValue:o.filters.searchTerm,"onUpdate:modelValue":l[0]||(l[0]=t=>o.filters.searchTerm=t),placeholder:"搜索项目名称...",clearable:"",onInput:o.debounceSearch},null,8,["modelValue","onInput"])]),_:1}),e(g,{span:5},{default:a(()=>[e(z,{modelValue:o.filters.status,"onUpdate:modelValue":l[1]||(l[1]=t=>o.filters.status=t),placeholder:"项目状态",style:{width:"100%"},onChange:l[2]||(l[2]=t=>o.loadProjects())},{default:a(()=>[e(_,{label:"所有状态",value:""}),e(_,{label:"进行中",value:"进行中"}),e(_,{label:"已完成",value:"已完成"}),e(_,{label:"已取消",value:"已取消"})]),_:1},8,["modelValue"])]),_:1}),e(g,{span:5},{default:a(()=>[e(z,{modelValue:o.filters.priority,"onUpdate:modelValue":l[3]||(l[3]=t=>o.filters.priority=t),placeholder:"优先级",style:{width:"100%"},onChange:l[4]||(l[4]=t=>o.loadProjects())},{default:a(()=>[e(_,{label:"所有优先级",value:""}),e(_,{label:"高",value:"高"}),e(_,{label:"中",value:"中"}),e(_,{label:"低",value:"低"})]),_:1},8,["modelValue"])]),_:1}),e(g,{span:6},{default:a(()=>[e(f,{type:"info",onClick:o.resetFilters},{default:a(()=>l[8]||(l[8]=[u("重置筛选")])),_:1},8,["onClick"])]),_:1})]),_:1})])]),_:1}),e(k,null,{default:a(()=>[e(q,{modelValue:o.activeTab,"onUpdate:modelValue":l[5]||(l[5]=t=>o.activeTab=t),onTabClick:o.handleTabClick},{default:a(()=>[e(s,{label:"我的项目",name:"myProjects"},{default:a(()=>[o.loading.myProjects?(n(),p("div",X,[e(C,{size:24,class:"is-loading"},{default:a(()=>[e(T)]),_:1}),l[9]||(l[9]=c("span",null,"加载中...",-1))])):o.myProjects.length===0?(n(),v(V,{key:1,description:"您还没有创建任何项目，点击右上角创建按钮开始"})):(n(),v(h,{key:2,gutter:20},{default:a(()=>[(n(!0),p(U,null,E(o.myProjects,t=>(n(),v(g,{key:t.id,xs:24,sm:12,md:8,lg:8},{default:a(()=>[e(k,{class:"project-card",shadow:"hover"},{default:a(()=>[c("div",Y,[c("h4",Z,[e(m,{to:{name:"ProjectDetail",params:{id:t.id}}},{default:a(()=>[u(r(t.name),1)]),_:2},1032,["to"])]),e(y,{type:o.getStatusTagType(t.status)},{default:a(()=>[u(r(t.status),1)]),_:2},1032,["type"])]),c("p",$,r(t.description||"暂无描述"),1),c("div",ee,[e(y,{type:"info",effect:"plain",size:"small",class:"mr-1"},{default:a(()=>[u("优先级: "+r(t.priority),1)]),_:2},1024),t.members&&t.members.length?(n(),v(y,{key:0,type:"info",effect:"plain",size:"small"},{default:a(()=>[u(r(t.members.length)+" 名成员 ",1)]),_:2},1024)):w("",!0)]),c("div",te,[t.start_date?(n(),p("div",ae,"开始: "+r(o.formatDate(t.start_date)),1)):w("",!0),t.end_date?(n(),p("div",oe,"结束: "+r(o.formatDate(t.end_date)),1)):w("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1}),e(s,{label:"参与的项目",name:"joinedProjects"},{default:a(()=>[o.loading.joinedProjects?(n(),p("div",le,[e(C,{size:24,class:"is-loading"},{default:a(()=>[e(T)]),_:1}),l[10]||(l[10]=c("span",null,"加载中...",-1))])):o.joinedProjects.length===0?(n(),v(V,{key:1,description:"您还没有参与任何其他人创建的项目"})):(n(),v(h,{key:2,gutter:20},{default:a(()=>[(n(!0),p(U,null,E(o.joinedProjects,t=>(n(),v(g,{key:t.id,xs:24,sm:12,md:8,lg:8},{default:a(()=>[e(k,{class:"project-card",shadow:"hover"},{default:a(()=>[c("div",se,[c("h4",ne,[e(m,{to:{name:"ProjectDetail",params:{id:t.id}}},{default:a(()=>[u(r(t.name),1)]),_:2},1032,["to"])]),e(y,{type:o.getStatusTagType(t.status)},{default:a(()=>[u(r(t.status),1)]),_:2},1032,["type"])]),c("p",re,r(t.description||"暂无描述"),1),c("div",ie,[e(y,{type:"info",effect:"plain",size:"small",class:"mr-1"},{default:a(()=>[u("优先级: "+r(t.priority),1)]),_:2},1024),e(y,{type:"dark",effect:"plain",size:"small"},{default:a(()=>{var S;return[u("创建者: "+r(((S=t.creator)==null?void 0:S.username)||"未知"),1)]}),_:2},1024)]),c("div",de,[t.start_date?(n(),p("div",ce,"开始: "+r(o.formatDate(t.start_date)),1)):w("",!0),t.end_date?(n(),p("div",_e,"结束: "+r(o.formatDate(t.end_date)),1)):w("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1}),e(s,{label:"所有项目",name:"allProjects"},{default:a(()=>[o.loading.allProjects?(n(),p("div",ue,[e(C,{size:24,class:"is-loading"},{default:a(()=>[e(T)]),_:1}),l[11]||(l[11]=c("span",null,"加载中...",-1))])):o.allProjects.length===0?(n(),v(V,{key:1,description:"暂无符合条件的项目"})):(n(),p("div",me,[e(I,{data:o.allProjects,style:{width:"100%"},border:"",stripe:""},{default:a(()=>[e(d,{prop:"name",label:"项目名称"},{default:a(t=>[e(m,{to:{name:"ProjectDetail",params:{id:t.row.id}}},{default:a(()=>[u(r(t.row.name),1)]),_:2},1032,["to"])]),_:1}),e(d,{prop:"status",label:"状态",width:"100"},{default:a(t=>[e(y,{type:o.getStatusTagType(t.row.status)},{default:a(()=>[u(r(t.row.status),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"priority",label:"优先级",width:"100"}),e(d,{prop:"creator.username",label:"创建者",width:"120"}),e(d,{label:"开始日期",width:"120"},{default:a(t=>[u(r(o.formatDate(t.row.start_date)),1)]),_:1}),e(d,{label:"结束日期",width:"120"},{default:a(t=>[u(r(o.formatDate(t.row.end_date)),1)]),_:1}),e(d,{label:"操作",width:"80",fixed:"right"},{default:a(t=>[e(f,{type:"primary",link:"",size:"small",onClick:S=>L.$router.push({name:"ProjectDetail",params:{id:t.row.id}})},{default:a(()=>l[12]||(l[12]=[u(" 查看 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),o.pagination.total>0?(n(),p("div",fe,[e(M,{background:"",layout:"prev, pager, next","current-page":o.pagination.currentPage,"page-size":o.pagination.perPage,total:o.pagination.total,onCurrentChange:o.goToPage},null,8,["current-page","page-size","total","onCurrentChange"])])):w("",!0)]))]),_:1})]),_:1},8,["modelValue","onTabClick"])]),_:1})])}const ye=R(H,[["render",pe],["__scopeId","data-v-b504ffca"]]);export{ye as default};
