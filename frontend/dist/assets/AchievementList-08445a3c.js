import{_ as P,y as _,C as j,z as G,c as z,b as w,d as t,w as l,D as H,g as A,a as R,B as T,E as q,r as s,G as J,o as y,e as d,H as O,I as Q,F as W,t as X}from"./index-9a8ac2de.js";const Y={class:"achievement-list"},Z={class:"page-header"},ee={class:"pagination-container"},te={__name:"AchievementList",setup(ae){const k=R(),i=_([]),g=_(!1),r=_(1),f=_(10),u=_(0),n=j({type:"",keyword:""}),p=async()=>{g.value=!0;try{const a={page:r.value,per_page:f.value,only_mine:"false"};n.type&&(a.type=n.type),n.keyword&&(a.keyword=n.keyword),console.log("请求参数:",a);const e=await T.get("/api/v1/achievements",{params:a});console.log("成果列表响应:",e.data),e.data&&Array.isArray(e.data)?(i.value=e.data,u.value=e.data.length):e.data&&e.data.items&&Array.isArray(e.data.items)?(i.value=e.data.items,u.value=e.data.total||e.data.items.length):(i.value=[],u.value=0,console.warn("响应数据格式不符合预期:",e.data))}catch(a){console.error("获取成果列表失败:",a),q.error("获取成果列表失败"),i.value=[],u.value=0}finally{g.value=!1}},V=()=>{n.type="",n.keyword="",r.value=1,p()},h=()=>{r.value=1,p()},x=a=>{f.value=a,p()},D=a=>{r.value=a,p()},S=a=>{k.push(`/achievements/${a}`)},$=a=>{k.push(`/achievements/${a}/edit`)},B=a=>a?new Date(a).toLocaleDateString():"-";return G(()=>{p()}),(a,e)=>{const c=s("el-button"),m=s("el-option"),F=s("el-select"),b=s("el-form-item"),L=s("el-input"),U=s("el-form"),C=s("el-card"),v=s("el-table-column"),E=s("el-table"),M=s("el-pagination"),N=s("el-empty"),I=J("loading");return y(),z("div",Y,[w("div",Z,[e[6]||(e[6]=w("h2",{class:"page-title"},"成果展示",-1)),t(c,{type:"primary",onClick:e[0]||(e[0]=o=>a.$router.push("/achievements/create"))},{default:l(()=>e[5]||(e[5]=[d("添加成果")])),_:1})]),t(C,{class:"filter-card mb-20"},{default:l(()=>[t(U,{inline:!0,model:n,class:"filter-form",onSubmit:O(h,["prevent"])},{default:l(()=>[t(b,{label:"成果类型"},{default:l(()=>[t(F,{modelValue:n.type,"onUpdate:modelValue":e[1]||(e[1]=o=>n.type=o),placeholder:"全部类型",clearable:""},{default:l(()=>[t(m,{label:"论文",value:"论文"}),t(m,{label:"专利",value:"专利"}),t(m,{label:"项目",value:"项目"}),t(m,{label:"奖项",value:"奖项"}),t(m,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"关键词"},{default:l(()=>[t(L,{modelValue:n.keyword,"onUpdate:modelValue":e[2]||(e[2]=o=>n.keyword=o),placeholder:"搜索标题或作者",clearable:"",onKeyup:Q(h,["enter"])},null,8,["modelValue"])]),_:1}),t(b,null,{default:l(()=>[t(c,{type:"primary",onClick:h},{default:l(()=>e[7]||(e[7]=[d("搜索")])),_:1}),t(c,{onClick:V},{default:l(()=>e[8]||(e[8]=[d("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),H((y(),A(C,null,{default:l(()=>[i.value&&i.value.length>0?(y(),z(W,{key:0},[t(E,{data:i.value,style:{width:"100%"}},{default:l(()=>[t(v,{prop:"title",label:"标题","min-width":"200"}),t(v,{prop:"achievement_type",label:"类型",width:"100"}),t(v,{prop:"authors",label:"作者","min-width":"150"}),t(v,{prop:"publish_date",label:"发布日期",width:"120"},{default:l(o=>[d(X(B(o.row.publish_date)),1)]),_:1}),t(v,{label:"操作",width:"150",fixed:"right"},{default:l(o=>[t(c,{size:"small",onClick:K=>S(o.row.id)},{default:l(()=>e[9]||(e[9]=[d(" 查看 ")])),_:2},1032,["onClick"]),t(c,{size:"small",type:"primary",onClick:K=>$(o.row.id)},{default:l(()=>e[10]||(e[10]=[d(" 编辑 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),w("div",ee,[t(M,{"current-page":r.value,"onUpdate:currentPage":e[3]||(e[3]=o=>r.value=o),"page-size":f.value,"onUpdate:pageSize":e[4]||(e[4]=o=>f.value=o),"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",total:u.value,onSizeChange:x,onCurrentChange:D},null,8,["current-page","page-size","total"])])],64)):(y(),A(N,{key:1,description:"暂无成果数据"}))]),_:1})),[[I,g.value]])])}}},oe=P(te,[["__scopeId","data-v-41e64c86"]]);export{oe as default};
